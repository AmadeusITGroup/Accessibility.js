{"version":3,"sources":["Focus.js"],"names":["jQuery","Error","$","AccFocus","element","options","$element","$options","extend","DEFAULTS","data","init","prototype","getDefaults","setFocus","that","_toggle","click","focusCallback","on","e","keyCode","_timeoutPeriod","setTimeout","_focusAction","_nextId","focus","_ariaExpanded","_ariaexpandedToggle","_returnId","document","bind","_escKeyHandler","is","attr","_escAction","unbind","_menubar","fn","accFocus","option","each","$this"],"mappings":"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","file":"acessibility.js","sourcesContent":["\r\nif (typeof jQuery === 'undefined') {\r\n   throw new Error('Accessibility JavaScript requires jQuery');\r\n}\r\n+function ($) {\r\n    'use strict';\r\n\r\n    // focus management PUBLIC CLASS DEFINITION\r\n\r\n    var AccFocus = function (element, options) {\r\n        this.$element = $(element);\r\n        this.$options = $.extend({}, AccFocus.DEFAULTS, options);\r\n        this.$element.data(\"accFocus\", this);\r\n        this.init();\r\n    };\r\n\r\n    AccFocus.DEFAULTS = $.extend({}, {\r\n    });\r\n\r\n    AccFocus.prototype.getDefaults = function () {\r\n        return AccFocus.DEFAULTS;\r\n    };\r\n\r\n    AccFocus.prototype.setFocus = function () {\r\n        //make this an option to add focus, hover etc\r\n        var that = this;\r\n        if (this._toggle === 'click') {\r\n            this.$element.click(focusCallback);\r\n        } else if (this._toggle === 'tab') {\r\n            this.$element.on('keyup', function (e) {\r\n                if (/*that.$element.is(':focus') &&*/ e.keyCode === 9) {\r\n                    focusCallback();\r\n                }\r\n            });\r\n        }\r\n\r\n        function focusCallback() {\r\n            if(that._timeoutPeriod) {\r\n                setTimeout(function () {\r\n                    that._focusAction();\r\n                }, that._timeoutPeriod);\r\n            } else {\r\n                that._focusAction();\r\n            }\r\n        }\r\n    };\r\n    AccFocus.prototype._focusAction = function () {\r\n        $('[data-accessibility-focus-target=\"' + this._nextId + '\"]').focus();\r\n        if(this._ariaExpanded) {\r\n            this._ariaexpandedToggle();\r\n        }\r\n        if(this._returnId) {\r\n            $(document).bind('keyup',{that: this},this._escKeyHandler);\r\n        }\r\n    };\r\n    AccFocus.prototype._ariaexpandedToggle = function () {\r\n        if($('[data-accessibility-focus-target=\"' + this._nextId + '\"]').is(':visible')) {\r\n            $('[data-accessibility-focus-return=\"' + this._returnId + '\"]').attr('aria-expanded','true');\r\n        } else {\r\n            $('[data-accessibility-focus-return=\"' + this._returnId + '\"]').attr('aria-expanded','false');\r\n        }\r\n    };\r\n    AccFocus.prototype._escKeyHandler = function (e) {\r\n        var that = e.data.that;\r\n        if (e.keyCode === 27) {\r\n            if(that._timeoutPeriod) {\r\n                setTimeout(function () {\r\n                    that._escAction();\r\n                }, that._timeoutPeriod);\r\n            } else {\r\n                that._escAction();\r\n            }\r\n        }\r\n    };\r\n    AccFocus.prototype._escAction = function () {\r\n        $(document).unbind('keyup', this._escKeyHandler);\r\n        $('[data-accessibility-focus-return=\"' + this._returnId + '\"]').focus();\r\n        this._ariaexpandedToggle();\r\n    };\r\n\r\n    AccFocus.prototype.init = function () {\r\n        this._returnId = this.$element.attr('data-accessibility-focus-return');\r\n        this._nextId = this.$element.attr('data-accessibility-focus-next');\r\n        this._timeoutPeriod = this.$element.attr('data-accessibility-timeout');\r\n        this._ariaExpanded = this.$element.attr('aria-expanded');\r\n        this._menubar = this.$element.attr('data-accessibility-menu-item-parent');\r\n        this._toggle = this.$element.attr('data-accessibility-toggle-method');\r\n        this.setFocus();\r\n    };\r\n    $.fn.accFocus = function (option) {\r\n        return this.each(function () {\r\n            var $this   = $(this);\r\n            var data    = $this.data('accFocus');\r\n            var options = typeof option === 'object' && option;\r\n\r\n            if (!data && option === 'destroy') {\r\n                return;\r\n            }\r\n            if (!data) {\r\n                data = new AccFocus(this, options);\r\n                $this.data('accFocus', data);\r\n            }\r\n            if (typeof option === 'string') {\r\n                return data[option]();\r\n            }\r\n        });\r\n    };\r\n}(jQuery);\r\n\r\n(function($) {\r\n    //managing focus for popups\r\n    $('[data-accessibility-focus-next]').each(function(){\r\n        $(this).accFocus();\r\n    });\r\n\r\n})(jQuery);\r\n"]}